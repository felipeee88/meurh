<div class="user-form-container">
  <mat-card class="form-card">
    <mat-card-header>
      <mat-card-title>Cadastro de Usuário</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Nome</mat-label>
          <input matInput formControlName="name" placeholder="Digite o nome do usuário" />
          <mat-icon matPrefix>person</mat-icon>
          @if (name?.hasError('required') && name?.touched) {
            <mat-error>Nome é obrigatório</mat-error>
          }
          @if (name?.hasError('minlength') && name?.touched) {
            <mat-error>Nome deve ter pelo menos 3 caracteres</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>E-mail</mat-label>
          <input matInput type="email" formControlName="email" placeholder="Digite o e-mail do usuário" />
          <mat-icon matPrefix>email</mat-icon>
          @if (email?.hasError('required') && email?.touched) {
            <mat-error>E-mail é obrigatório</mat-error>
          }
          @if (email?.hasError('email') && email?.touched) {
            <mat-error>E-mail inválido</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Senha</mat-label>
          <input
            matInput
            type="password"
            formControlName="password"
            placeholder="Digite a senha"
          />
          <mat-icon matPrefix>lock</mat-icon>
          @if (password?.hasError('required') && password?.touched) {
            <mat-error>Senha é obrigatória</mat-error>
          }
          @if (password?.hasError('minlength') && password?.touched) {
            <mat-error>Senha deve ter pelo menos 6 caracteres</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Confirmar Senha</mat-label>
          <input
            matInput
            type="password"
            formControlName="confirmPassword"
            placeholder="Confirme a senha"
          />
          <mat-icon matPrefix>lock_outline</mat-icon>
          @if (confirmPassword?.hasError('required') && confirmPassword?.touched) {
            <mat-error>Confirmação de senha é obrigatória</mat-error>
          }
          @if (userForm.hasError('passwordMismatch') && confirmPassword?.touched && confirmPassword?.dirty) {
            <mat-error>As senhas não coincidem</mat-error>
          }
        </mat-form-field>

        @if (errorMessage) {
          <div class="error-message">{{ errorMessage }}</div>
        }

        <div class="form-actions">
          <button
            mat-raised-button
            type="button"
            (click)="onCancel()"
            [disabled]="isLoading"
          >
            Cancelar
          </button>
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="userForm.invalid || isLoading"
          >
            @if (isLoading) {
              <span>Salvando...</span>
            } @else {
              <span>Salvar</span>
            }
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
